import{d as E,r as b,g as I,p as C,h as T,q as Q,n as X,o as N,c as B,j as U,a as w,s as $,x as k,w as V,y as F,t as P,F as z,i as j,z as Z,_ as J,A as _,B as x}from"./bootstrap-29242f3c.mjs";var ee=Object.defineProperty,M=Object.getOwnPropertySymbols,te=Object.prototype.hasOwnProperty,ne=Object.prototype.propertyIsEnumerable,W=(e,t,n)=>t in e?ee(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,ae=(e,t)=>{for(var n in t||(t={}))te.call(t,n)&&W(e,n,t[n]);if(M)for(var n of M(t))ne.call(t,n)&&W(e,n,t[n]);return e};const oe={scale:Number,thick:Number,palette:Object,index:Number,start:Number,vertical:Boolean,value:Number,isShowReferLine:Boolean};var D=(e,t)=>{for(const[n,r]of t)e[n]=r;return e};const re=E({name:"LineRuler",props:oe,emits:["onMouseDown","onRelease","onRemove"],setup(e,{emit:t}){const n=b(0),r=b(!0);I(()=>{n.value=e.value});const u=l=>{r.value=l>=0},c=C(()=>{const l=(n.value-e.start)*e.scale;u(l);const s=l+"px";return e.vertical?{top:s}:{left:s}}),a=C(()=>{var l;const s=`1px solid ${(l=e.palette)==null?void 0:l.lineColor}`,h=e.vertical?{borderTop:s}:{borderLeft:s},f=e.isShowReferLine?e.vertical?"ns-resize":"ew-resize":"none";return ae({cursor:f},h)}),i=C(()=>e.vertical?{left:e.thick+"px"}:{top:e.thick+"px"});return{startValue:n,showLine:r,offset:c,borderCursor:a,actionStyle:i,handleDown:l=>{const s=e.vertical?l.clientY:l.clientX,h=n.value;t("onMouseDown");const f=S=>{const v=e.vertical?S.clientY:S.clientX,m=Math.round(h+(v-s)/e.scale);n.value=m},R=()=>{t("onRelease",n.value,e.index),document.removeEventListener("mousemove",f),document.removeEventListener("mouseup",R)};document.addEventListener("mousemove",f),document.addEventListener("mouseup",R)},handleRemove:()=>{t("onRemove",e.index)}}}}),le={class:"value"};function se(e,t,n,r,u,c){return V((N(),B("div",{class:"line",style:k([e.offset,e.borderCursor]),onMousedown:t[1]||(t[1]=(...a)=>e.handleDown&&e.handleDown(...a))},[w("div",{class:"action",style:k(e.actionStyle)},[w("span",{class:"del",onClick:t[0]||(t[0]=(...a)=>e.handleRemove&&e.handleRemove(...a))},"\xD7"),w("span",le,P(e.startValue),1)],4)],36)),[[F,e.showLine]])}var ie=D(re,[["render",se],["__scopeId","data-v-57e51382"]]);const ce=e=>e<=.25?40:e<=.5?20:e<=1?10:e<=2?5:e<=4?2:1,q=.83,ue=(e,t,n,r,u,c)=>{const{scale:a,width:i,height:d,ratio:o,palette:l}=u,{bgColor:s,fontColor:h,shadowColor:f,longfgColor:R,shortfgColor:S}=l;if(e.scale(o,o),e.clearRect(0,0,i,d),e.fillStyle=s,e.fillRect(0,0,i,d),r){const y=(n-t)*a,p=r*a;e.fillStyle=f,c?e.fillRect(y,0,p,d*3/8):e.fillRect(0,y,i*3/8,p)}const v=ce(a),m=v*a,g=v*10,L=g*a,O=Math.floor(t/v)*v,Y=Math.floor(t/g)*g,H=(O-t)/v*m,G=(Y-t)/g*L,K=t+Math.ceil((c?i:d)/a);e.beginPath(),e.fillStyle=h,e.strokeStyle=R;for(let y=Y,p=0;y<K;y+=g,p++){const A=G+p*L+.5;c?e.moveTo(A,0):e.moveTo(0,A),e.save(),c?e.translate(A,d*.4):e.translate(i*.4,A),c||e.rotate(-Math.PI/2),e.scale(q/o,q/o),e.fillText(y.toString(),4*o,7*o),e.restore(),c?e.lineTo(A,d*9/16):e.lineTo(i*9/16,A)}e.stroke(),e.closePath(),e.beginPath(),e.strokeStyle=S;for(let y=O,p=0;y<K;y+=v,p++){const A=H+p*m+.5;c?e.moveTo(A,0):e.moveTo(0,A),y%g!=0&&(c?e.lineTo(A,d*1/4):e.lineTo(i*1/4,A))}e.stroke(),e.closePath(),e.setTransform(1,0,0,1,0,0)},de=E({name:"CanvasRuler",props:{showIndicator:Boolean,valueNum:Number,scale:Number,ratio:Number,palette:Object,vertical:Boolean,start:Number,width:Number,height:Number,selectStart:Number,selectLength:Number},emits:["onAddLine","update:showIndicator","update:valueNum"],setup(e,{emit:t}){const n=T({canvasContext:null});let r=1;const u=b(null);I(()=>{r=e.ratio||window.devicePixelRatio||1,c(),a(r),i(r)});const c=()=>{n.canvasContext=u.value&&u.value.getContext("2d")},a=o=>{if(u.value){u.value.width=e.width*o,u.value.height=e.height*o;const l=n.canvasContext;l&&(l.font=`${12*o}px -apple-system,
                "Helvetica Neue", ".SFNSText-Regular",
                "SF UI Text", Arial, "PingFang SC", "Hiragino Sans GB",
                "Microsoft YaHei", "WenQuanYi Zen Hei", sans-serif`,l.lineWidth=1,l.textBaseline="middle")}},i=o=>{const l={scale:e.scale,width:e.width,height:e.height,palette:e.palette,ratio:o};n.canvasContext&&ue(n.canvasContext,e.start,e.selectStart,e.selectLength,l,!e.vertical)};return Q(()=>e.start,()=>i(r)),Q([()=>e.width,()=>e.height],()=>{a(r),i(r)}),{handle:(o,l)=>{const s=(R,S,v)=>Math.round(S+R/v),h=e.vertical?o.offsetY:o.offsetX,f=s(h,e.start,e.scale);switch(l){case"click":t("onAddLine",f);break;case"enter":t("update:valueNum",f),t("update:showIndicator",!0);break;default:t("update:valueNum",f);break}},canvas:u}}});function he(e,t,n,r,u,c){return N(),B("canvas",{ref:"canvas",class:"ruler",onClick:t[0]||(t[0]=a=>e.handle(a,"click")),onMouseenter:t[1]||(t[1]=a=>e.handle(a,"enter")),onMousemove:t[2]||(t[2]=a=>e.handle(a,"move")),onMouseleave:t[3]||(t[3]=a=>e.$emit("update:showIndicator",!1))},null,544)}var ve=D(de,[["render",he]]);const fe={scale:Number,ratio:Number,thick:Number,palette:Object,vertical:{type:Boolean,default:!0},width:{type:Number,default:200},height:{type:Number,default:200},start:{type:Number,default:0},lines:{type:Array,default:()=>[]},selectStart:{type:Number},selectLength:{type:Number},isShowReferLine:{type:Boolean}},me=E({name:"RulerWrapper",components:{CanvasRuler:ve,RulerLine:ie},props:fe,setup(e){const t=b(!1),n=b(0),r=C(()=>e.vertical?"v-container":"h-container"),u=C(()=>{const o={width:`calc(100% - ${e.thick}px)`,height:`${e.thick+1}px`,left:`${e.thick}px`},l={width:`${e.thick&&e.thick+1}px`,height:`calc(100% - ${e.thick}px)`,top:`${e.thick}px`};return e.vertical?l:o}),c=C(()=>{var o;const l=(n.value-e.start)*e.scale;let s="top",h="borderLeft";return s=e.vertical?"top":"left",h=e.vertical?"borderBottom":"borderLeft",{[s]:l+"px",[h]:`1px solid ${(o=e.palette)==null?void 0:o.lineColor}`}}),a=o=>{e.lines.push(o)},i=(o,l)=>{const s=o-e.start,h=(e.vertical?e.height:e.width)/e.scale;s<0||s>h?d(l):e.lines[l]=o},d=o=>{e.lines.splice(o,1)};return{showIndicator:t,valueNum:n,rwClassName:r,rwStyle:u,indicatorStyle:c,handleNewLine:a,handleLineRelease:i,handleLineRemove:d}}}),we={class:"lines"},ge={class:"value"};function Ae(e,t,n,r,u,c){const a=X("CanvasRuler"),i=X("RulerLine");return N(),B("div",{class:$(e.rwClassName),style:k(e.rwStyle)},[U(a,{vertical:e.vertical,scale:e.scale,width:e.width,height:e.height,start:e.start,ratio:e.ratio,"select-start":e.selectStart,"select-length":e.selectLength,palette:e.palette,valueNum:e.valueNum,"onUpdate:valueNum":t[0]||(t[0]=d=>e.valueNum=d),showIndicator:e.showIndicator,"onUpdate:showIndicator":t[1]||(t[1]=d=>e.showIndicator=d),onOnAddLine:e.handleNewLine},null,8,["vertical","scale","width","height","start","ratio","select-start","select-length","palette","valueNum","showIndicator","onOnAddLine"]),V(w("div",we,[(N(!0),B(z,null,j(e.lines,(d,o)=>(N(),Z(i,{key:d+o,index:o,value:d>>0,scale:e.scale,start:e.start,thick:e.thick,palette:e.palette,vertical:e.vertical,"is-show-refer-line":e.isShowReferLine,onOnRemove:e.handleLineRemove,onOnRelease:e.handleLineRelease},null,8,["index","value","scale","start","thick","palette","vertical","is-show-refer-line","onOnRemove","onOnRelease"]))),128))],512),[[F,e.isShowReferLine]]),V(w("div",{class:"indicator",style:k(e.indicatorStyle)},[w("div",ge,P(e.valueNum),1)],4),[[F,e.showIndicator]])],6)}var Ce=D(me,[["render",Ae],["__scopeId","data-v-121a2df8"]]);const ye="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABUAAAAVCAYAAACpF6WWAAAAAXNSR0IArs4c6QAAAopJREFUOE/FlE9IVEEcx7+/N9ouds1Mu0QUSFZYdIgoUqQoKPBQHsKozpXE7jbTO/U8xLJvn6usBHWQ6hBFXupSkQeVbh0KJEPp0sH+eLGTsKs77xcj78m0ax0E8cHjzZv5zef3/c33xxA24KENYGJzoEEQbNNaN4Zh2OQ4znwYhr9c1/39vwrXVDo0NNS0tLR0GYB5D64BmAMwzMyvlFKz1es10Hw+f4mZ7wHYBeA9gNdENFepVOaEEM3M3OI4Thczn41gt6WUgQ3+C+r7/h0AWQD3mXnYqPA8L9nQ0HCemduIaFpKOWoAhUJhT6VSuQXgOjP3K6W8GLwKzeVyp4jonR0QBEErM48w8zFLyayUsjX+z+VyHhHdZebTSqkxM78CHRgYOKS1/ghgVErZY214RkQ7ADyRUj72ff8qgCtmXUrZGcf5vv8CwEUhxOF0Ov1pBRpla5dSdseBhUJhpznH6tIsZb1KqacW+BGArUaUXX63UuplHJTNZjuEEONSyhozfd/n6mQ1RkXZL2itz7mu+80EDA4ONi8vL/8AcM2UbikyR2BU9cSmmTU70YqKIAj2hWFo2uenlHK/BRg3Y2aeNO5GyU8S0ZbFxcUuz/NKEXAGQKPjOCcymcyX1dIi8DSAiWQyeaavr68cbSgCuBknYubnQoj+TCYzUywWE6VS6S2ADsdx2gxw1X3L7SNENMbMnwE8qK+vf5NKpRaMaeVyeW8ikfiaSqW+R7BuZr5BRMe11p2u607U9Gk8kc/ntzPzQwCmExYATDLzVBiGE0KIowAOADDf3QA+aK2VDaxRajto3K+rq+tl5nYAzQBamHmeiOYBTGmtR6ph/1Rqg9c73pz7dD1qN0TpHyNQRCUDJXrAAAAAAElFTkSuQmCC",Re="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABUAAAAVCAYAAACpF6WWAAAAAXNSR0IArs4c6QAAAjtJREFUOE/NlD9oFEEUxn9v9ghC0hpRUogIAUmniGAT/5Q2FrETPSNRJILg7RwimI0ox85eQFCEBGIUO1PYpFM0jSConQoBEZGgGPsgl+w+2eM2bC57SopAFqYZ3v7m+977ZoQt+GQLmGxPaBiGgYiMWWvXBHZUGoZhH3BERPYC+4F+4Keq/urt7b1RLpf/ZEBVHa9Wq0HWyg3QKIoGVPU8cA7wgK/pUtXPQJ8xZk+pVBpuNBqXUoUiEvi+P56fzTpo6+SbwHNg1lo7WzTITGEKXFlZeeB53tVCpa3CK8AFa+1cBgvD8LKIXAQOJkkyICJDeYVBEJS6u7s/qeoLa+1o+l9TqXNuBLhmjDlbqVQ+5ICjInIfOBPH8W9jzGCR5YmJiRNxHM+papgqzqDvgSlr7VTernPuO3An3c9bBt74vv+yrdaKyLDv+/1Sq9UGPc97nY9EVuycU2AQOA7cAm4Dr4D5TvVxHB9rKo2iaEFVp621Ln96FEUngaOqGmSxabVqsh3a2h+x1h5qQjNrae/yE4+iaCwDJkky73neTuBZe129Xk+H+BS4l7ZqLVIZ2BhzuFKpvMsDVXXWGPMxFdAedOfcKeCRqj7MYrUhpz09PfXl5eXrectFWXXODQHpOq2qd/95o/JXr6ura3J1dXU6SZIfwKKIHAD2tVYMPBGRx77vN10UXtO85fTkmZmZHUtLSzUR2QXsBhaAL6r6DXhbrVYXi1yss59GqOgub/bN3Z7v6X/tb9Zmp/q/kN8s+lJb8oEAAAAASUVORK5CYII=",Se={eyeIcon:{type:String},closeEyeIcon:{type:String},scale:{type:Number,default:1},ratio:{type:Number},thick:{type:Number,default:16},palette:Object,startX:{type:Number},startY:{type:Number,default:0},width:{type:Number,default:200},height:{type:Number,default:200},shadow:{type:Object,default:()=>({x:0,y:0,width:0,height:0})},lines:{type:Object,default:()=>({h:[],v:[]})},cornerActive:{type:Boolean,default:!1},isShowReferLine:{type:Boolean,default:!0}},pe=E({name:"SketchRule",components:{RulerWrapper:Ce},props:Se,emits:["onCornerClick","handleLine"],setup(e,{emit:t}){let n=b(!0);n.value=e.isShowReferLine;const r=C(()=>{function i(o,l){return Object.keys(o).forEach(s=>{s&&o.hasOwnProperty(s)&&(typeof l.key=="object"?o[s]=i(o[s],l[s]):l.hasOwnProperty(s)&&(o[s]=l[s]))}),o}return i({bgColor:"rgba(225,225,225, 0)",longfgColor:"#BABBBC",shortfgColor:"#C8CDD0",fontColor:"#7D8694",shadowColor:"#E8E8E8",lineColor:"#EB5648",borderColor:"#DADADC",cornerActiveColor:"rgb(235, 86, 72, 0.6)",menu:{bgColor:"#fff",dividerColor:"#DBDBDB",listItem:{textColor:"#415058",hoverTextColor:"#298DF8",disabledTextColor:"rgba(65, 80, 88, 0.4)",bgColor:"#fff",hoverBgColor:"#F2F2F2"}}},e.palette||{})}),u=C(()=>e.cornerActive?" active":""),c=C(()=>({backgroundImage:n.value?`url(${e.eyeIcon||ye})`:`url(${e.closeEyeIcon||Re})`,width:e.thick+"px",height:e.thick+"px",borderRight:`1px solid ${r.value.borderColor}`,borderBottom:`1px solid ${r.value.borderColor}`}));return{isShowReferLine:n,paletteCpu:r,cornerActiveClass:u,cornerStyle:c,onCornerClick:i=>{n.value=!n.value,t("onCornerClick",i)}}}}),be={id:"mb-ruler",class:"style-ruler mb-ruler"};function Ne(e,t,n,r,u,c){const a=X("RulerWrapper");return N(),B("div",be,[U(a,{vertical:!1,width:e.width,height:e.thick,"is-show-refer-line":e.isShowReferLine,thick:e.thick,ratio:e.ratio,start:e.startX,lines:e.lines.h,"select-start":e.shadow.x,"select-length":e.shadow.width,scale:e.scale,palette:e.paletteCpu},null,8,["width","height","is-show-refer-line","thick","ratio","start","lines","select-start","select-length","scale","palette"]),U(a,{vertical:!0,width:e.thick,height:e.height,"is-show-refer-line":e.isShowReferLine,thick:e.thick,ratio:e.ratio,start:e.startY,lines:e.lines.v,"select-start":e.shadow.y,"select-length":e.shadow.height,scale:e.scale,palette:e.paletteCpu},null,8,["width","height","is-show-refer-line","thick","ratio","start","lines","select-start","select-length","scale","palette"]),w("a",{class:$(["corner",e.cornerActiveClass]),style:k(e.cornerStyle),onClick:t[0]||(t[0]=(...i)=>e.onCornerClick&&e.onCornerClick(...i))},null,6)])}var Be=D(pe,[["render",Ne]]);const ke=E({setup(e,{expose:t}){t();const n=600,r=320,u=b(null),c=b(null),a=T({scale:2,startX:0,startY:0,lines:{h:[433,588],v:[33,143]},thick:20,isShowRuler:!0,isShowReferLine:!0}),i=C(()=>({x:0,y:0,width:n,height:r})),d=C(()=>({width:n,height:r,transform:`scale(${a.scale})`}));I(()=>{u.value.scrollLeft=c.value.getBoundingClientRect().width/2-400});const o=()=>{const m=document.querySelector("#screens").getBoundingClientRect(),g=document.querySelector("#canvas").getBoundingClientRect(),L=(m.left+a.thick-g.left)/a.scale,O=(m.top+a.thick-g.top)/a.scale;a.startX=L,a.startY=O},l=m=>{if(m.ctrlKey||m.metaKey){m.preventDefault();const g=parseFloat(Math.max(.2,a.scale-m.deltaY/500).toFixed(2));a.scale=g}x(()=>{o()})},{scale:s,startX:h,startY:f,lines:R,thick:S}=_(a),v={rectWidth:n,rectHeight:r,screensRef:u,containerRef:c,state:a,shadow:i,canvasStyle:d,handleScroll:o,handleWheel:l,scale:s,startX:h,startY:f,lines:R,thick:S,SketchRule:Be};return Object.defineProperty(v,"__isScriptSetup",{enumerable:!1,value:!0}),v}}),Ee={class:"top"},Le={class:"wrapper"},Oe={ref:"containerRef",class:"screen-container"};function Ue(e,t,n,r,u,c){return N(),B(z,null,[w("div",Ee,"\u7F29\u653E\u6BD4\u4F8B:"+P(r.scale),1),w("div",Le,[U(r.SketchRule,{thick:r.thick,scale:r.scale,width:1380,height:780,"start-x":r.startX,"start-y":r.startY,shadow:r.shadow,lines:r.lines},null,8,["thick","scale","start-x","start-y","shadow","lines"]),w("div",{id:"screens",ref:"screensRef",onWheel:r.handleWheel,onScroll:r.handleScroll},[w("div",Oe,[w("div",{id:"canvas",style:k(r.canvasStyle)},null,4)],512)],544)])],64)}var Ie=J(ke,[["render",Ue]]);export{Ie as default};
